@{
    ViewData["Title"] = "Cookies - Register of Regulated Qualifications";
    Layout = "_LayoutCookie.cshtml";
}

<div class="govuk-grid-row">
    <div id="cookiesFormSubmitted" class="govuk-grid-column-two-thirds" hidden="">
        <div class="govuk-notification-banner govuk-notification-banner--success" role="alert" aria-labelledby="govuk-notification-banner-title" data-module="govuk-notification-banner">
            <div class="govuk-notification-banner__header">
                <h2 class="govuk-notification-banner__title" id="govuk-notification-banner-title">
                    Success
                </h2>
            </div>
            <div class="govuk-notification-banner__content">
                <p class="govuk-notification-banner__heading">
                    You’ve set your cookie preferences. <a class="govuk-notification-banner__link" onclick="event.preventDefault(); GoBackWithRefresh(); return false;" href="!#">Go back to the page you were looking at</a>.
                </p>
            </div>
        </div>
    </div>

    <div class="govuk-grid-column-two-thirds">
        <form method="post" id="cookie-form" novalidate="" onsubmit="event.preventDefault(); submitCookieForm()">
            <h1 class="govuk-heading-l">Cookies on Find a regulated qualification and Find a regulated awarding organisation</h1>
            <div class="govuk-inset-text">
                Your selection here will apply to the both the 'find a regulated qualification' and 'find a regulated awarding organisation' services.
            </div>
            <p class="govuk-body">Cookies are files saved on your phone, tablet or computer when you visit a website.</p>
            <p class="govuk-body">We use cookies to collect and store information about how you use this digital service, such as the pages you visit.</p>
            <p class="govuk-body">This page has a brief explanation of each type of cookie we use.</p>

            <h2 class="govuk-heading-m">Cookie settings</h2>
            <p class="govuk-body">We use 2 types of cookie. You can choose which cookies you're happy for us to use.</p>

            <h3 class="govuk-heading-s">Strictly necessary cookies</h3>
            <p class="govuk-body">We use your web browser's 'session storage' to temporarily store which qualifications you have selected to compare. The data is deleted when you close the browser tab. The service would not work properly without this data, so it is not possible for you to decline its usage.</p>
            <p class="govuk-body">We use this data to:</p>

            <ul class="govuk-list govuk-list--bullet">
                <li>remember which qualifications you have selected to compare</li>
                <li>allow you to select qualifications from different pages of search results</li>
            </ul>

            <hr class="govuk-section-break govuk-section-break--l govuk-section-break--visible">

            <h3 class="govuk-heading-s">Cookies to measure performance</h3>
            <p class="govuk-body">Some cookies are stored in your browser to allow us to measure the performance of our service. We use a service called Matomo to measure how you use this and other and Ofqual digital services. The Matomo service uses cookies to collect information about:</p>

            <ul class="govuk-list govuk-list--bullet">
                <li>how you got to this service</li>
                <li>the pages you visit and how long you spend on each page</li>
                <li>what you click on while you're using this service</li>
                <li>which parts of our service do and don't work well for users</li>
            </ul>

            <div class="govuk-form-group">
                <fieldset class="govuk-fieldset">
                    <legend class="govuk-fieldset__legend govuk-fieldset__legend--s">
                        Do you want to accept performance measurement cookies?
                    </legend>
                    <div class="govuk-radios" data-module="govuk-radios">
                        <div class="govuk-radios__item">
                            <input class="govuk-radios__input" id="cookies-analytics-yes" name="cookies-analytics" type="radio" value="yes">
                            <label class="govuk-label govuk-radios__label" for="cookies-analytics-yes">
                                Yes
                            </label>
                        </div>
                        <div class="govuk-radios__item">
                            <input class="govuk-radios__input" id="cookies-analytics-no" name="cookies-analytics" type="radio" value="no">
                            <label class="govuk-label govuk-radios__label" for="cookies-analytics-no">
                                No
                            </label>
                        </div>
                    </div>
                </fieldset>
            </div>
            <button type="submit" role="button" draggable="false" class="govuk-button" data-module="govuk-button">
                Save cookie settings
            </button>
            <hr class="govuk-section-break govuk-section-break--xl govuk-section-break--visible">

            <h2 class="govuk-heading-m">Cookie details</h2>

            <table class="govuk-table">
                <caption class="govuk-table__caption govuk-table__caption--s">Cookie details: performance measurement</caption>
                <thead class="govuk-table__head">
                    <tr class="govuk-table__row">
                        <th scope="col" class="govuk-table__header">Cookie name</th>
                        <th scope="col" class="govuk-table__header">Purpose</th>
                        <th scope="col" class="govuk-table__header">Expiry time</th>
                    </tr>
                </thead>

                <tbody class="govuk-table__body">
                    <tr class="govuk-table__row">
                        <th scope="row" class="govuk-table__header">_pk_id</th>
                        <td class="govuk-table__cell">Recognize repeat visits by the same user</td>
                        <td class="govuk-table__cell">13 months</td>
                    </tr>
                    <tr class="govuk-table__row">
                        <th scope="row" class="govuk-table__header">_pk_ref</th>
                        <td class="govuk-table__cell">Store the address of the initial website that linked you to this service</td>
                        <td class="govuk-table__cell">6 months</td>
                    </tr>
                    <tr class="govuk-table__row">
                        <th scope="row" class="govuk-table__header">_pk_ses</th>
                        <td class="govuk-table__cell">Store temporary data for this visit</td>
                        <td class="govuk-table__cell">30 minutes</td>
                    </tr>
                    <tr class="govuk-table__row">
                        <th scope="row" class="govuk-table__header">pk_cvar</th>
                        <td class="govuk-table__cell">Store temporary data for this visit</td>
                        <td class="govuk-table__cell">30 minutes</td>
                    </tr>
                    <tr class="govuk-table__row">
                        <th scope="row" class="govuk-table__header">_pk_hsr</th>
                        <td class="govuk-table__cell">Store temporary data for this visit</td>
                        <td class="govuk-table__cell">30 minutes</td>
                    </tr>
                    <tr class="govuk-table__row">
                        <th scope="row" class="govuk-table__header">_pk_testcookie</th>
                        <td class="govuk-table__cell">Test if your browser supports cookies</td>
                        <td class="govuk-table__cell">Immediate</td>
                    </tr>
                    <tr class="govuk-table__row">
                        <th scope="row" class="govuk-table__header">mtm_consent</th>
                        <td class="govuk-table__cell">Remember if you have consented</td>
                        <td class="govuk-table__cell">30 years</td>
                    </tr>
                    <tr class="govuk-table__row">
                        <th scope="row" class="govuk-table__header">mtm_consent_removed</th>
                        <td class="govuk-table__cell">Remember if you have consented</td>
                        <td class="govuk-table__cell">30 years</td>
                    </tr>
                    <tr class="govuk-table__row">
                        <th scope="row" class="govuk-table__header">mtm_cookie_consent</th>
                        <td class="govuk-table__cell">Remember if you have consented</td>
                        <td class="govuk-table__cell">30 years</td>
                    </tr>
                    <tr class="govuk-table__row">
                        <th scope="row" class="govuk-table__header">matomo_ignore</th>
                        <td class="govuk-table__cell">Opt-out of tracking</td>
                        <td class="govuk-table__cell">30 years</td>
                    </tr>
                    <tr class="govuk-table__row">
                        <th scope="row" class="govuk-table__header">matomo_sessid</th>
                        <td class="govuk-table__cell">Non-identifiable data to recognise a sequence of page views as belonging to a single user</td>
                        <td class="govuk-table__cell">14 days</td>
                    </tr>
                </tbody>
            </table>
        </form>
    </div>
</div>

@section Scripts {
    <script type="text/javascript">
        if (analyticsEnabled()) {
            document.getElementById("cookies-analytics-yes").setAttribute("checked", "");
            document.getElementById("cookies-analytics-no").removeAttribute("checked");
        } else {
            document.getElementById("cookies-analytics-yes").removeAttribute("checked");
            document.getElementById("cookies-analytics-no").setAttribute("checked", "");
        }

        function submitCookieForm() {
            var val = document.querySelector('input[name="cookies-analytics"]:checked').value

            if (val == "on") {
                setMatomoCookie("enabled");
            } else {
                setMatomoCookie("disabled");
            }

            document.getElementById("cookiesFormSubmitted").removeAttribute("hidden");
            window.scrollTo(0, 0);
        }

        function GoBackWithRefresh(event) {
            if ('referrer' in document) {
                window.location = document.referrer;
            } else {
                window.history.back();
            }
        }
    </script>
}